



































































































































































































































































































   


















































   



   











































































































































































































































































































































































.686 
.XMM 
.MODEL flat, c 
ASSUME fs:_DATA 
.CODE






EXTERN FreeLibrary@4:PROC
EXTERN process_attach:PROC




    

























        DllMain@12 PROC

        cmp      dword ptr [8 + esp], 1
        jne      DllMain_not_pattach




         
 call process_attach 
 lea esp, [4*0 + esp]







        



        
        mov      eax, [esp]
        mov      [8 + esp], eax
        
        mov      eax, [4 + esp]
        mov      [12 + esp], eax
        
        add      esp, 8

        jmp      FreeLibrary@4
DllMain_not_pattach:
        mov      eax, 1



        ret      00ch

        DllMain@12 ENDP


END
